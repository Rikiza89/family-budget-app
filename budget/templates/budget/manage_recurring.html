<!-- templates/budget/manage_recurring.html -->
{% extends 'budget/base.html' %}
{% load i18n %}
{% load translation_tags %}
{% block content %}
<div class="p-4">
    <div class="flex justify-between items-center mb-6">
        <h2 class="text-2xl font-bold">ğŸ”„ {% trans "å®šæœŸå–å¼•ç®¡ç†" %}</h2>
        <a href="{% url 'add_recurring' %}" class="bg-blue-600 text-white px-4 py-2 rounded-lg">â• {% trans "è¿½åŠ " %}</a>
    </div>

    <!-- One-Click Generate Button -->
<div class="bg-green-50 p-4 rounded-lg mb-6 text-center">
    <a href="{% url 'generate_all_recurring' %}"
       class="inline-block w-full bg-green-600 text-white py-4 rounded-lg font-bold text-lg hover:bg-green-700">
        âš¡ {% trans "ã™ã¹ã¦ã®å®šæœŸå–å¼•ã‚’ä¸€æ‹¬è¨˜éŒ²" %}
    </a>
    <p class="text-sm text-gray-600 mt-2">{% trans "ä»Šæ—¥è¨˜éŒ²ã™ã¹ãå®šæœŸå–å¼•ã‚’ã¾ã¨ã‚ã¦ç™»éŒ²" %}</p>
</div>


    <!-- Active Templates -->
    <div class="space-y-3">
        {% for template in templates %}
        <div class="bg-white p-4 rounded-lg shadow">
            <div class="flex justify-between items-start">
                <div class="flex-1">
                    <h3 class="font-bold text-lg">{{ template.category.name|translate }}</h3>
                    <p class="text-gray-600">Â¥{{ template.amount|floatformat:0 }}</p>
                    <p class="text-sm text-gray-500 mt-1">
                        {{ template.get_frequency_display|translate }} |
                        {% trans "é–‹å§‹" %}: {{ template.start_date }}
                        {% if template.last_generated %}
                        | {% trans "æœ€çµ‚" %}: {{ template.last_generated }}
                        {% endif %}
                    </p>
                </div>
                <div class="flex space-x-2">
                    <a href="{% url 'toggle_recurring' template.id %}"
                       class="text-sm {% if template.is_active %}text-green-600{% else %}text-gray-400{% endif %} hover:underline">
                        {% if template.is_active %}{% trans "æœ‰åŠ¹" %}{% else %}{% trans "ç„¡åŠ¹" %}{% endif %}
                    </a>
                </div>
            </div>
        </div>
        {% empty %}
        <p class="text-gray-500 text-center py-8">{% trans "å®šæœŸå–å¼•ãŒã‚ã‚Šã¾ã›ã‚“" %}</p>
        {% endfor %}
    </div>
</div>
{% endblock %}
